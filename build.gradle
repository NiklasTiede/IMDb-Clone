plugins {
	id 'org.springframework.boot' version '3.0.1'
	id 'io.spring.dependency-management' version '1.0.11.RELEASE'
	id 'java'
	id 'com.diffplug.spotless' version '6.7.2'
}

group = 'com.thecodinglab'
version = '1.0.0'

compileJava {
	sourceCompatibility = JavaVersion.VERSION_17
	targetCompatibility = JavaVersion.VERSION_17
}

repositories {
	mavenCentral()
}

compileJava.dependsOn 'spotlessApply'

spotless {
	java {
		target 'src/main/java/**/*.java'
		targetExclude 'build/**', 'frontend/**'
		targetExclude 'src/main/java/**/payload/*.java', 'src/main/java/**/payload/**/*.java'
		importOrder()
		removeUnusedImports()
		trimTrailingWhitespace()
		googleJavaFormat()
		toggleOffOn()
	}
}

def springBootVersion = '3.0.2'

dependencies {
	// starters
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-web', version: "$springBootVersion"
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-webflux', version: "$springBootVersion"
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-data-jpa', version: "$springBootVersion"

	// MySQL Database
	implementation group: 'mysql', name: 'mysql-connector-java', version: '8.0.31'

	// documentation - swagger ui
	implementation group: 'org.springdoc', name: 'springdoc-openapi-starter-webmvc-ui', version: '2.0.2'

	// serialization / deserialization
	implementation group: 'com.fasterxml.jackson.core', name: 'jackson-core', version: '2.14.1'
	implementation group: 'com.fasterxml.jackson.dataformat', name: 'jackson-dataformat-csv', version: '2.14.1'

	// validation
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-validation', version: "$springBootVersion"

	// mapstruct mapping classes with many fields
	implementation group: 'org.mapstruct', name: 'mapstruct', version: '1.5.3.Final'
	annotationProcessor group: 'org.mapstruct', name: 'mapstruct-processor', version: '1.5.3.Final'

	// security: JWT / OAuth2
	implementation group: 'io.jsonwebtoken', name: 'jjwt-api', version: '0.11.5'
	runtimeOnly group: 'io.jsonwebtoken', name: 'jjwt-impl', version: '0.11.5'
	runtimeOnly group: 'io.jsonwebtoken', name: 'jjwt-jackson', version: '0.11.5'

	implementation group: 'org.springframework.security.oauth', name: 'spring-security-oauth2', version: '2.5.2.RELEASE'

	// Email
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-mail', version: "$springBootVersion"

	// Code Formatter
	implementation group: 'com.diffplug.spotless', name: 'spotless-plugin-gradle', version: '6.12.0'

	// SearchEngine
	implementation group: 'org.springframework.data', name: 'spring-data-elasticsearch', version: '5.0.1'

	// File Storage
	implementation group: 'io.minio', name: 'minio', version: '8.5.1'

	// monitoring
	implementation group: 'org.springframework.boot', name: 'spring-boot-starter-actuator', version: "$springBootVersion"

	// Testing
	testImplementation group: 'org.springframework.boot', name: 'spring-boot-starter-test', version: "$springBootVersion"
	testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: '5.9.1'
	testImplementation group: 'com.github.stefanbirkner', name: 'system-rules', version: '1.19.0'
}

test {
	useJUnitPlatform()
}
